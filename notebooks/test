логаріфмічний розподіл

plt.figure(figsize=(6,4))
sns.histplot(df_orders['Orders.total'], bins=40, kde=True, log_scale=True)
plt.title("Histogram (Log Scale): Orders.total")
plt.xlabel("Orders.total (log scale)")
plt.show()

=====================================================================


#for col in integer_list:
    df[col] = (
        df[col]
        .astype(str)
        .str.strip()
        .str.replace(r'\.0$', '', regex=True)
        .replace({'': None, 'nan': None, 'NaN': None})
        .astype('Int64')               
    )


=====================================================================

#df['Orders.coupon_id'] = (
    #df['Orders.coupon_id']
    .astype(str)
    .str.strip()
    .str.replace(r'\.0$', '', regex=True)
    .replace({'nan': None, 'None': None, '': None})
    .astype('string')
)

=====================================================================

plt.figure(figsize=(8, 6))

# Крос-таблиця у відсотках
ct = pd.crosstab(
    df_orders['Orders.payment_method'],
    df_orders['Orders.payment_status'],
    normalize='index'
) * 100

# Heatmap
sns.heatmap(
    ct,
    annot=True,
    fmt=".1f",
    cmap='Blues'
)

plt.title('Payment Status by Payment Method (%)')
plt.xlabel('Payment Status')
plt.ylabel('Payment Method')

plt.tight_layout()
plt.show()
=====================================================================


=====================================================================


=====================================================================


=====================================================================


=====================================================================


=====================================================================


=====================================================================
